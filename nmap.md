# Nmap

## Live Host Discovery

<table>
<thead>
	<tr>
		<th>Scan Type</th>
		<th>Example Command</th>
	</tr>
</thead>
<tbody>
	<tr>
		<td> Scan</td>
		<td><code>sudo nmap -PR -sn MACHINE_IP/24</code></td>
	</tr>
	<tr>
		<td>ICMP Echo Scan</td>
		<td><code>sudo nmap -PE -sn MACHINE_IP/24</code></td>
	</tr>
	<tr>
		<td>ICMP Timestamp Scan</td>
		<td><code>sudo nmap -PP -sn MACHINE_IP/24</code></td>
	</tr>
	<tr>
		<td>ICMP Address Mask Scan</td>
		<td><code>sudo nmap -PM -sn MACHINE_IP/24</code></td>
	</tr>
	<tr>
		<td>TCP SYN Ping Scan</td>
		<td><code>sudo nmap -PS22,80,443 -sn MACHINE_IP/30</code></td>
	</tr>
	<tr>
		<td>TCP ACK Ping Scan</td>
		<td><code>sudo nmap -PA22,80,443 -sn MACHINE_IP/30</code></td>
	</tr>
	<tr>
		<td>UDP Ping Scan</span></td>
		<td><code>sudo nmap -PU53,161,162 -sn MACHINE_IP/30</code></td>
	</tr>
</tbody>
</table>

Remember to add `-sn` if you are only interested in host discovery without port-scanning. Omitting `-sn` will let Nmap default to port-scanning the live hosts.

<table>
<thead>
	<tr>
		<th>Option</th>
		<th>Purpose</th>
	</tr>
</thead>
<tbody>
	<tr>
		<td><code>-n</code></td>
		<td>no DNS lookup</span></td>
	</tr>
	<tr>
		<td><code>-R</code></td>
		<td>reverse-DNS lookup for all hosts</td>
	</tr>
	<tr>
		<td><code>-sn</code></td>
		<td>host discovery only without port-scanning</td>
	</tr>
</tbody>
</table>

## Basic Port Scans


<table>
<thead>
	<tr>
		<th>Port Scan Type</th>
		<th>Example Command</th>
	</tr>
</thead>
<tbody>
	<tr>
		<td>TCP Connect Scan</td>
		<td><code>nmap -sT MACHINE_IP</code></td>
	</tr>
	<tr>
		<td><span>TCP SYN Scan</td>
		<td><code>sudo nmap -sS MACHINE_IP</code></td>
	</tr>
	<tr>
		<td>UDP Scan</td>
		<td><code>sudo nmap -sU MACHINE_IP</code></td>
	</tr>
</tbody>
</table>

<table>
<thead>
	<tr>
		<th>Option</th>
		<th>Purpose</th>
	</tr>
</thead>
<tbody>
	<tr>
		<td><code>-p-</code></td>
		<td>all ports</td>
	</tr>
	<tr>
		<td><code>-p1-1023</code></td>
		<td>scan ports 1 to 1023</td>
	</tr>
	<tr>
		<td><code>-F</code></td>
		<td>100 most common ports</td>
	</tr>
	<tr>
		<td><code>-r</code></td>
		<td>scan ports in consecutive order</td>
	</tr>
	<tr>
		<td><code>-T&amp;lt;0-5&amp;gt;</code></td>
		<td>-T0 being the slowest and T5 the fastest</td>
	</tr>
	<tr>
		<td><code>--max-rate 50</code></td>
		<td>rate &lt;= 50 packets/sec</td>
	</tr>
	<tr>
		<td><code>--min-rate 15</code></td>
		<td>rate &gt;= 15 packets/sec</td>
	</tr>
	<tr>
		<td><code>--min-parallelism 100</code></td>
		<td>at least 100 probes in parallel</td>
	</tr>
</tbody>
</table>

## Advanced Port Scans

<table>
<thead>
	<tr>
		<th>Option</th>
		<th>Meaning</th>
	</tr>
</thead>
<tbody>
	<tr>
		<td><code>-sV</code></td>
		<td>determine service/version info on open ports</td>
	</tr>
	<tr>
		<td><code>-sV --version-light</code></td>
		<td>try the most likely probes (2)</td>
	</tr>
	<tr>
		<td><code>-sV --version-all</code></td>
		<td>try all available probes (9)</td>
	</tr>
	<tr>
		<td><code>-O</code></td>
		<td>detect OS</td>
	</tr>
	<tr>
		<td><code>--traceroute</code></td>
		<td>run traceroute to target</td>
	</tr>
	<tr>
		<td><code>--script=SCRIPTS</code></td>
		<td>Nmap scripts to run</td>
	</tr>
	<tr>
		<td><code>-sC</code> or <code>--script=default</code></td>
		<td>run default scripts</td>
	</tr>
	<tr>
		<td><code>-A</code></td>
		<td>equivalent to <code>-sV -O -sC --traceroute</code></td>
	</tr>
	<tr>
		<td><code>-oN</code></td>
		<td>save output in normal format</td>
	</tr>
	<tr>
		<td><code>-oG</code></td>
		<td>save output in grepable format</td>
	</tr>
	<tr>
		<td><code>-oX</code></td>
		<td>save output in XML format</td>
	</tr>
	<tr>
		<td><code>-oA</code></td>
		<td>save output in normal, XML and Grepable formats</td>
	</tr>
</tbody>
</table>

## Post Port Scans


<table>
<thead>
	<tr>
		<th>Option</th>
		<th>Meaning</th>
	</tr>
</thead>
<tbody>
	<tr>
		<td><code>-sV</code></td>
		<td>determine service/version info on open ports</td>
	</tr>
	<tr>
		<td><code>-sV --version-light</code></td>
		<td>try the most likely probes (2)</td>
	</tr>
	<tr>
		<td><code>-sV --version-all</code></td>
		<td>try all available probes (9)</td>
	</tr>
	<tr>
		<td><code>-O</code></td>
		<td>detect OS</td>
	</tr>
	<tr>
		<td><code>--traceroute</code></td>
		<td>run traceroute to target</td>
	</tr>
	<tr>
		<td><code>--script=SCRIPTS</code></td>
		<td>Nmap scripts to run</td>
	</tr>
	<tr>
		<td><code>-sC</code> or <code>--script=default</code></td>
		<td>run default scripts</td>
	</tr>
	<tr>
		<td><code>-A</code></td>
		<td>equivalent to <code>-sV -O -sC --traceroute</code></td>
	</tr>
	<tr>
		<td><code>-oN</code></td>
		<td>save output in normal format</td>
	</tr>
	<tr>
		<td><code>-oG</code></td>
		<td>save output in grepable format</td>
	</tr>
	<tr>
		<td><code>-oX</code></td>
		<td>save output in XML format</td>
	</tr>
	<tr>
		<td><code>-oA</code></td>
		<td>save output in normal, XML and Grepable formats</td>
	</tr>
</tbody>
</table>

